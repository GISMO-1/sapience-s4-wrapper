# Golden Demo Dataset + Determinism Regression Harness

## What this is
The golden dataset is a deterministic snapshot of governance outputs generated by the API gateway using an in-process
Fastify app with in-memory stores. It captures intent seeds, outcomes, policy replays, guardrails, promotions, rollback,
reconciliation, provenance, and verification results. The snapshot lives in `artifacts/golden-baseline.json` and is used
by a regression test to catch unexpected drift in policy decisions or report hashes.

## When to update
Update the baseline **only** when intentional policy, logic, or output changes are expected. This keeps the harness
useful for detecting regressions.

## How to update
Use the Makefile target, which regenerates the demo artifacts and copies the baseline.

```bash
make golden
```

## How to check in CI/local
Run the golden-only regression test:

```bash
make golden-check
```

## Golden demo script
Purpose: Generate a deterministic golden snapshot (JSON + Markdown) using in-process Fastify inject calls.  
Inputs: None required. Optional flags: `--self-check`, `--help`.  
Outputs: `artifacts/golden-demo.json`, `artifacts/golden-demo.md`.

Example:

```bash
pnpm -C interfaces/api-gateway exec tsx ../../scripts/golden-demo.ts
```

Self-check:

```bash
pnpm -C interfaces/api-gateway exec tsx ../../scripts/golden-demo.ts --self-check
```
